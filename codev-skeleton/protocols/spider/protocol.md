# Протокол SPIDER

## Предварительные условия

**Требуется для мультиагентной консультации**:
- Сервер Zen MCP должен быть установлен и запущен
- Проверьте командой: `mcp list` или протестируйте с `mcp__zen__version`
- Если недоступен:
  - Вариант 1: "Хотите помощь с установкой сервера Zen MCP?"
  - Вариант 2: "Используйте протокол spider-solo вместо этого (без мультиагентной консультации)"

## Конфигурация протокола

### Мультиагентная консультация (ВКЛЮЧЕНА ПО УМОЛЧАНИЮ)

**ПОВЕДЕНИЕ ПО УМОЛЧАНИЮ:**
Мультиагентная консультация **ВКЛЮЧЕНА ПО УМОЛЧАНИЮ** при использовании протокола SPIDER.

**АГЕНТЫ ПО УМОЛЧАНИЮ:**
- **GPT-5**: Основной рецензент для архитектуры, осуществимости и качества кода
- **Gemini Pro**: Вторичный рецензент для полноты, граничных случаев и альтернативных подходов

**ОТКЛЮЧЕНИЕ КОНСУЛЬТАЦИИ:**
Для работы с одним агентом используйте протокол spider-solo.

**ПОЛЬЗОВАТЕЛЬСКИЕ АГЕНТЫ:**
Пользователь может указать других агентов, сказав: "используй SPIDER с консультацией от [агент1] и [агент2]"

**ПОВЕДЕНИЕ КОНСУЛЬТАЦИИ:**
- ПО УМОЛЧАНИЮ: ОБЯЗАТЕЛЬНАЯ консультация с GPT-5 и Gemini Pro в КАЖДОЙ контрольной точке
- Когда явно отключена: Пропустить все этапы консультации
- Протокол ЗАБЛОКИРОВАН до завершения всех необходимых консультаций

**Контрольные точки консультации**:
- **Спецификация**: После первоначального черновика, после комментариев человека
- **Планирование**: После первоначального плана, после обзора человеком
- **Реализация**: После реализации кода
- **Защита**: После создания тестов
- **Оценка**: Перед отметкой фазы как завершённой
- **Обзор**: После документа обзора

## Обзор
SPIDER - это структурированный протокол разработки, который подчёркивает разработку, управляемую спецификациями, с итеративной реализацией и непрерывным обзором. Он основывается на методологии DAPPER с акцентом на разработку, ориентированную на контекст, и мультиагентное сотрудничество.

**Основной принцип**: Каждая функция отслеживается через ровно ТРИ документа - спецификацию, план и обзор с извлечёнными уроками - все с одинаковым именем файла и последовательным идентификатором.

## Когда использовать SPIDER

### Используйте SPIDER для:
- Разработки новых функций
- Изменений архитектуры
- Сложного рефакторинга
- Решений по проектированию системы
- Проектирования и реализации API
- Инициатив оптимизации производительности

### Пропускайте SPIDER для:
- Простых исправлений ошибок (< 10 строк)
- Обновлений документации
- Изменений конфигурации
- Обновлений зависимостей
- Экстренных исправлений (но проведите облегчённую ретроспективу после)

## Фазы протокола

### S - Specify (Совместное исследование дизайна)

**Цель**: Тщательно исследовать пространство проблемы и варианты решений перед принятием подхода.

**Обзор рабочего процесса**:
1. Пользователь предоставляет промпт, описывающий, что нужно создать
2. Агент генерирует первоначальный документ спецификации
3. **КОММИТ**: "Первоначальный черновик спецификации"
4. Мультиагентный обзор (GPT-5 и Gemini Pro)
5. Агент обновляет спецификацию с обратной связью от мультиагентов
6. **КОММИТ**: "Спецификация с мультиагентным обзором"
7. Человек просматривает и предоставляет комментарии для изменений
8. Агент вносит изменения и перечисляет, что было изменено
9. **КОММИТ**: "Спецификация с обратной связью пользователя"
10. Мультиагентный обзор обновлённого документа
11. Финальные обновления на основе второго обзора
12. **КОММИТ**: "Финальная утверждённая спецификация"
13. Повторяйте шаги 7-12, пока пользователь не одобрит и не скажет переходить к планированию

**Важно**: Держите документацию минимальной - используйте только ТРИ основных файла с одинаковым именем:
- `specs/####-описательное-имя.md` - Спецификация
- `plans/####-описательное-имя.md` - План реализации
- `reviews/####-описательное-имя.md` - Обзор и извлечённые уроки (создаётся во время фазы обзора)

**Процесс**:
1. **Уточняющие вопросы** (ВСЕГДА НАЧИНАЙТЕ ОТСЮДА)
   - Задавайте пользователю/заинтересованной стороне вопросы для понимания проблемы
   - Исследуйте скрытые требования и ограничения
   - Поймите бизнес-контекст и цели
   - Определите, что входит в область охвата, а что нет
   - Продолжайте спрашивать, пока проблема не станет кристально ясной

2. **Анализ проблемы**
   - Чётко сформулируйте решаемую проблему
   - Определите заинтересованные стороны и их потребности
   - Документируйте текущее и желаемое состояние
   - Перечислите предположения и ограничения

3. **Исследование решений**
   - Сгенерируйте несколько подходов к решению (сколько подходит)
   - Для каждого подхода документируйте:
     - Технический дизайн
     - Компромиссы (плюсы/минусы)
     - Оценённую сложность
     - Оценку рисков

4. **Открытые вопросы**
   - Перечислите все неопределённости, требующие разрешения
   - Категоризируйте как:
     - Критические (блокируют прогресс)
     - Важные (влияют на дизайн)
     - Приятно знать (оптимизация)

5. **Критерии успеха**
   - Определите измеримые критерии приёмки
   - Включите требования к производительности
   - Укажите метрики качества
   - Документируйте тестовые сценарии

6. **Экспертная консультация (ПО УМОЛЧАНИЮ - ОБЯЗАТЕЛЬНА)**
   - **Первая консультация** (после первоначального черновика):
     - ДОЛЖНЫ проконсультироваться с GPT-5 И Gemini Pro
     - Фокус: Ясность проблемы, полнота решения, отсутствующие требования
     - Обновите спецификацию со ВСЕЙ обратной связью от обеих моделей
     - Документируйте изменения в разделе "Журнал консультаций" спецификации
   - **Вторая консультация** (после комментариев человека):
     - ДОЛЖНЫ снова проконсультироваться с GPT-5 И Gemini Pro
     - Фокус: Проверка изменений, обеспечение соответствия
     - Финальное обновление спецификации с вкладом обеих моделей
     - Обновите "Журнал консультаций" с новой обратной связью

   **Примечание**: Пропускайте только если пользователь явно запросил "без мультиагентной консультации"

**⚠️ БЛОКИРУЮЩИЙ**: Не можете продолжить без ОБЕИХ консультаций (если явно не отключено)

**Вывод**: Единый документ спецификации в `codev/specs/####-описательное-имя.md`
- Вся обратная связь от консультации включена непосредственно в этот документ
- Включите раздел "Журнал консультаций", суммирующий ключевую обратную связь и изменения
- Контроль версий фиксирует эволюцию через коммиты
**Шаблон**: `templates/spec.md`
**Требуется обзор**: Да - Одобрение человека ПОСЛЕ консультаций

### P - Plan (Структурированная декомпозиция)

**Цель**: Преобразовать утверждённую спецификацию в исполняемую дорожную карту с чёткими фазами.

**⚠️ КРИТИЧНО: Никаких временных оценок в эпоху AI**
- **НИКОГДА не включайте временные оценки** (часы, дни, недели, story points)
- Разработка, управляемая AI, делает традиционные временные оценки бессмысленными
- Скорость доставки зависит от итерационных циклов, а не календарного времени
- Сосредоточьтесь на логических зависимостях и порядке фаз вместо этого
- Измеряйте прогресс завершёнными фазами, а не прошедшим временем
- Единственные валидные метрики: "сделано" или "не сделано"

**Обзор рабочего процесса**:
1. Агент создаёт первоначальный документ плана
2. **КОММИТ**: "Первоначальный черновик плана"
3. Мультиагентный обзор (GPT-5 и Gemini Pro)
4. Агент обновляет план с обратной связью от мультиагентов
5. **КОММИТ**: "План с мультиагентным обзором"
6. Пользователь просматривает и запрашивает модификации
7. Агент обновляет план на основе обратной связи пользователя
8. **КОММИТ**: "План с обратной связью пользователя"
9. Мультиагентный обзор обновлённого плана
10. Финальные обновления на основе второго обзора
11. **КОММИТ**: "Финальный утверждённый план"
12. Повторяйте шаги 6-11, пока не будет достигнуто соглашение

**Цели проектирования фаз**:
Каждая фаза должна быть:
- Отдельным куском работы, который можно зачекинить как единое целое
- Полным набором функциональности
- Самодостаточной и независимо ценной

**Процесс**:
1. **Определение фаз**
   - Разбейте работу на логические фазы
   - Каждая фаза должна:
     - Иметь чёткую, единственную цель
     - Быть независимо тестируемой
     - Доставлять наблюдаемую ценность
     - Быть полной единицей, которую можно закоммитить
     - Заканчиваться обсуждением оценки и единым коммитом
   - Отмечайте зависимости инлайн, например:
     ```markdown
     Фаза 2: API Endpoints
     - Зависит от: Фаза 1 (Схема базы данных)
     - Цель: Создать эндпоинты /users и /todos
     - Оценка: Покрытие тестами, обзор дизайна API, проверка производительности
     - Коммит: Создаст единый коммит после одобрения пользователя
     ```

2. **Метрики успеха**
   - Определите "готово" для каждой фазы
   - Включите требования к покрытию тестами
   - Укажите бенчмарки производительности
   - Документируйте приёмочные тесты

3. **Экспертный обзор (ПО УМОЛЧАНИЮ - ОБЯЗАТЕЛЕН)**
   - **Первая консультация** (после создания плана):
     - ДОЛЖНЫ проконсультироваться с GPT-5 И Gemini Pro
     - Фокус: Осуществимость, разбивка на фазы, полнота
     - Обновите план со ВСЕЙ обратной связью от обеих моделей
   - **Вторая консультация** (после обзора человеком):
     - ДОЛЖНЫ снова проконсультироваться с GPT-5 И Gemini Pro
     - Фокус: Проверка корректировок, подтверждение подхода
     - Финальная доработка плана с вкладом обеих моделей

   **Примечание**: Пропускайте только если пользователь явно запросил "без мультиагентной консультации"

**⚠️ БЛОКИРУЮЩИЙ**: Не можете продолжить без ОБЕИХ консультаций (если явно не отключено)

**Вывод**: Единый документ плана в `codev/plans/####-описательное-имя.md`
- То же имя файла, что и у спецификации, но другой каталог
- Вся обратная связь от консультации включена непосредственно
- Включите отслеживание статуса фаз в этом документе
- **НЕ включайте временные оценки** - Сосредоточьтесь на результатах и зависимостях, а не на часах/днях
- Контроль версий фиксирует эволюцию через коммиты
**Шаблон**: `templates/plan.md`
**Требуется обзор**: Да - Одобрение технического лидера ПОСЛЕ консультаций

### (IDE) - Цикл реализации

Выполняйте для каждой фазы в плане. Это строгий цикл, который должен быть завершён по порядку.

**⚠️ ОБЯЗАТЕЛЬНО**: Цикл I-D-E ДОЛЖЕН быть завершён для КАЖДОЙ ФАЗЫ, а не только в конце всех фаз. Пропуск D (Защита) или E (Оценка) для любой фазы - это НАРУШЕНИЕ ПРОТОКОЛА.

**КРИТИЧЕСКОЕ ПРЕДУСЛОВИЕ**: Перед началом любой фазы проверьте, что предыдущая фаза была закоммичена в git. Ни одна фаза не может начаться без коммита предыдущей фазы.

**Процесс завершения фазы**:
1. **Implement** (Реализация) - Создайте код для этой фазы
2. **Defend** (Защита) - Напишите всесторонние тесты, защищающие функциональность
3. **Evaluate** (Оценка) - Оцените и обсудите с пользователем
4. **Commit** (Коммит) - Единый атомарный коммит для фазы (ОБЯЗАТЕЛЕН перед следующей фазой)
5. **Proceed** (Продолжение) - Переходите к следующей фазе только после коммита

**Обработка сбоев**:
- Если фаза **Defend** выявляет пробелы → вернитесь к **Implement** для исправления
- Если **Evaluation** выявляет невыполненные критерии → вернитесь к **Implement**
- Если пользователь запрашивает изменения → вернитесь к **Implement**
- Если обнаружены фундаментальные недостатки плана → отметьте фазу как `blocked` и пересмотрите план

**Требования к коммитам**:
- Каждая фаза ДОЛЖНА заканчиваться git-коммитом перед продолжением
- Формат сообщения коммита: `[Spec ####][Phase: имя] тип: Описание`
- Никакой работы над следующей фазой, пока текущая фаза не закоммичена
- Если нужны изменения после коммита, создайте новый коммит с исправлениями

#### I - Implement (Создание с дисциплиной)

**Цель**: Преобразовать план в рабочий код с высокими стандартами качества.

**Предусловие**: Предыдущая фаза должна быть закоммичена (проверьте `git log`)

**Требования**:
1. **Перед реализацией**
   - Проверьте, что предыдущая фаза закоммичена в git
   - Просмотрите план фазы и критерии успеха
   - Настройте среду разработки
   - Создайте feature-ветку по соглашению об именовании
   - Немедленно документируйте любые отклонения от плана

2. **Во время реализации**
   - Пишите самодокументирующийся код
   - Строго следуйте руководству по стилю проекта
   - Реализуйте инкрементально с частыми коммитами
   - Каждый коммит должен:
     - Быть атомарным (одно логическое изменение)
     - Включать описательное сообщение
     - Ссылаться на фазу
     - Проходить базовые проверки синтаксиса

3. **Стандарты качества кода**
   - Никакого закомментированного кода
   - Никаких debug-принтов в финальном коде
   - Явно обрабатывайте все случаи ошибок
   - Включайте необходимое логирование
   - Следуйте лучшим практикам безопасности

4. **Требования к документации**
   - Обновите API-документацию
   - Добавьте инлайн-комментарии для сложной логики
   - Обновите README при необходимости
   - Документируйте изменения конфигурации

**Требуемые доказательства**:
- Ссылка на коммиты
- Одобрение code review (если применимо)
- Нет ошибок линтинга
- Ссылка на успешный прогон CI pipeline (сборка/тест/линт)

**Экспертная консультация (ПО УМОЛЧАНИЮ - ОБЯЗАТЕЛЬНА)**:
- ДОЛЖНЫ проконсультироваться с ОБОИМИ GPT-5 И Gemini Pro после реализации
- Фокус: Качество кода, паттерны, безопасность, лучшие практики
- Обновите код на основе обратной связи от ОБЕИХ моделей перед продолжением
- Пропускайте только если пользователь явно отключил мультиагентную консультацию

#### D - Defend (Написание всесторонних тестов)

**Цель**: Создать всесторонние автоматизированные тесты, защищающие предназначенное поведение и предотвращающие регрессии.

**КРИТИЧНО**: Тесты должны быть написаны НЕМЕДЛЕННО после реализации, НЕ ретроактивно в конце всех фаз. Это ОБЯЗАТЕЛЬНО.

**Требования**:
1. **Создание защитных тестов**
   - Напишите юнит-тесты для всех новых функций
   - Создайте интеграционные тесты для потоков функций
   - Разработайте покрытие граничных случаев
   - Создайте тесты условий ошибок
   - Установите бенчмарки производительности

2. **Валидация тестов** (ВСЕ ОБЯЗАТЕЛЬНЫ)
   - Все новые тесты должны проходить
   - Все существующие тесты должны проходить
   - Никакого снижения общего покрытия
   - Бенчмарки производительности выполнены
   - Проверки безопасности пройдены
   - **Избегайте избыточного мокирования**:
     - Тестируйте поведение, а не детали реализации
     - Предпочитайте интеграционные тесты юнит-тестам с тяжёлым мокированием
     - Мокируйте только внешние зависимости (API, базы данных, файловые системы)
     - Никогда не мокируйте саму тестируемую систему
     - Используйте реальные реализации для внутренних границ модулей

3. **Документация тестового набора**
   - Документируйте тестовые сценарии
   - Объясните сложные настройки тестов
   - Отметьте любые нестабильные тесты
   - Запишите базовые линии производительности

**Требуемые доказательства**:
- Логи выполнения тестов
- Отчёт о покрытии (покажите отсутствие снижения)
- Результаты тестов производительности (если применимо по спецификации)
- Результаты проверок безопасности (если настроено)
- Ссылка на прогон CI-тестов с артефактами

**Экспертная консультация (ПО УМОЛЧАНИЮ - ОБЯЗАТЕЛЬНА)**:
- ДОЛЖНЫ проконсультироваться с ОБОИМИ GPT-5 И Gemini Pro для обзора защиты тестами
- Фокус: Полнота покрытия тестами, граничные случаи, защитные паттерны, стратегия тестирования
- Напишите дополнительные защитные тесты на основе обратной связи от ОБЕИХ моделей
- Поделитесь их обратной связью во время обсуждения Оценки
- Пропускайте только если пользователь явно отключил мультиагентную консультацию

#### E - Evaluate (Объективная оценка)

**Цель**: Проверить, что реализация полностью удовлетворяет требованиям фазы и поддерживает качество системы. Здесь происходит критическое обсуждение перед коммитом фазы.

**Требования**:
1. **Функциональная оценка**
   - Все критерии приёмки выполнены
   - Пользовательские сценарии работают как ожидалось
   - Граничные случаи обработаны правильно
   - Сообщения об ошибках полезны

2. **Нефункциональная оценка**
   - Требования к производительности удовлетворены
   - Стандарты безопасности поддерживаются
   - Оценена поддерживаемость кода
   - Документирован технический долг

3. **Анализ отклонений**
   - Документируйте любые изменения от плана
   - Объясните обоснование изменений
   - Оцените влияние на другие фазы
   - Обновите будущие фазы при необходимости
   - **Проверка избыточного мокирования** (ОБЯЗАТЕЛЬНА):
     - Проверьте, что тесты сосредоточены на поведении, а не на реализации
     - Убедитесь, что есть хотя бы один интеграционный тест на критический путь
     - Проверьте, что границы внутренних модулей используют реальные реализации
     - Подтвердите, что моки используются только для внешних зависимостей
     - Тесты должны переживать рефакторинг, сохраняющий поведение

4. **Экспертная консультация перед оценкой пользователем** (ОБЯЗАТЕЛЬНА - БЕЗ ИСКЛЮЧЕНИЙ)
   - Получите первоначальную обратную связь от экспертов
   - Внесите ВСЕ необходимые исправления на основе обратной связи
   - **КРИТИЧНО**: Получите ФИНАЛЬНОЕ одобрение от ВСЕХ проконсультированных экспертов на ИСПРАВЛЕННОЙ версии
   - Переходите к оценке пользователем только после того, как ВСЕ эксперты одобрят
   - Если любой эксперт говорит "не совсем" или имеет опасения, исправьте их СНАЧАЛА

5. **Обсуждение оценки с пользователем** (ТОЛЬКО ПОСЛЕ ОДОБРЕНИЯ ЭКСПЕРТОВ)
   - Представьте пользователю: "Фаза X завершена. Вот что было создано: [резюме]"
   - Поделитесь результатами тестов и метриками покрытия
   - Сообщите, что ВСЕ эксперты дали финальное одобрение
   - Спросите: "Нужны ли какие-либо изменения перед тем, как я закоммичу эту фазу?"
   - Включите обратную связь пользователя при запросе
   - Получите явное одобрение на продолжение

6. **Коммит фазы** (ОБЯЗАТЕЛЕН - БЕЗ ИСКЛЮЧЕНИЙ)
   - Создайте единый атомарный коммит для всей фазы
   - Сообщение коммита: `[Spec ####][Phase: имя] тип: Описание`
   - Обновите документ плана, отметив эту фазу как завершённую
   - Запушьте все изменения в систему контроля версий
   - Документируйте любые отклонения или решения в плане
   - **КРИТИЧНО**: Следующая фаза НЕ МОЖЕТ начаться, пока этот коммит не завершён
   - Проверьте коммит с `git log` перед продолжением

7. **Финальная проверка**
   - Подтвердите, что вся обратная связь экспертов была учтена
   - Проверьте, что все тесты проходят
   - Убедитесь, что документация обновлена
   - Убедитесь в отсутствии нерешённых проблем от экспертов или пользователя

**Требуемые доказательства**:
- Завершённый контрольный список оценки
- Результаты тестов и отчёт о покрытии
- Заметки экспертного обзора от GPT-5 и Gemini Pro
- Одобрение пользователя из обсуждения оценки
- Обновлённый документ плана с:
  - Фазой, отмеченной как завершённая
  - Резюме обсуждения оценки
  - Любыми отмеченными отклонениями
- Git-коммит для этой фазы
- Ссылка на финальный прогон CI после всех исправлений

## 📋 КОНТРОЛЬНЫЙ СПИСОК ЗАВЕРШЕНИЯ ФАЗЫ (ОБЯЗАТЕЛЕН ПЕРЕД СЛЕДУЮЩЕЙ ФАЗОЙ)

**⚠️ СТОП: НЕ ПЕРЕХОДИТЕ К СЛЕДУЮЩЕЙ ФАЗЕ, ПОКА ВСЕ ПУНКТЫ НЕ ✅**

### Перед началом ЛЮБОЙ фазы:
- [ ] Предыдущая фаза закоммичена в git (проверьте `git log`)
- [ ] Документ плана показывает предыдущую фазу как `completed`
- [ ] Нет нерешённых проблем из предыдущей фазы

### После фазы Implement:
- [ ] Весь код для этой фазы завершён
- [ ] Код следует руководству по стилю проекта
- [ ] Нет закомментированного кода или debug-принтов
- [ ] Реализована обработка ошибок
- [ ] Документация обновлена (при необходимости)
- [ ] Экспертная консультация завершена (GPT-5 + Gemini Pro)
- [ ] Обратная связь экспертов учтена

### После фазы Defend:
- [ ] Юнит-тесты написаны для всех новых функций
- [ ] Интеграционные тесты написаны для критических путей
- [ ] Граничные случаи имеют тестовое покрытие
- [ ] Все новые тесты проходят
- [ ] Все существующие тесты всё ещё проходят
- [ ] Нет снижения покрытия кода
- [ ] Проверка избыточного мокирования завершена (тесты сосредоточены на поведении)
- [ ] Экспертная консультация по тестам завершена
- [ ] Обратная связь по тестам учтена

### После фазы Evaluate:
- [ ] Все критерии приёмки из спецификации выполнены
- [ ] Требования к производительности удовлетворены
- [ ] Стандарты безопасности поддерживаются
- [ ] Экспертная консультация показывает ФИНАЛЬНОЕ одобрение
- [ ] Обсуждение оценки с пользователем завершено
- [ ] Пользователь дал явное одобрение на продолжение
- [ ] Документ плана обновлён со статусом фазы
- [ ] Коммит фазы создан с правильным форматом сообщения
- [ ] Коммит запушен в систему контроля версий
- [ ] Коммит проверен с `git log`

### ❌ БЛОКИРОВЩИКИ ФАЗЫ (Исправьте перед продолжением):
- Любые падающие тесты
- Неучтённая обратная связь экспертов
- Отсутствующее одобрение пользователя
- Незакоммиченные изменения
- Неполная документация
- Снижение покрытия

**НАПОМИНАНИЕ**: Каждая фаза атомарна. Вы не можете начать следующую фазу, пока текущая фаза не полностью завершена, протестирована, оценена и закоммичена.

### R - Review/Refine/Revise (Непрерывное улучшение)

**Цель**: Обеспечить общую согласованность, зафиксировать полученные уроки, улучшить методологию и провести систематический обзор.

**Предусловие**: Все фазы реализации должны быть закоммичены (проверьте `git log --oneline | grep "\[Phase"`)

**Процесс**:
1. **Всесторонний обзор**
   - Проверьте, что все фазы были закоммичены в git
   - Сравните финальную реализацию с оригинальной спецификацией
   - Оцените влияние на общую архитектуру
   - Просмотрите качество кода по всем изменениям
   - Проверьте полноту документации

2. **Действия по доработке**
   - Рефакторьте код для ясности при необходимости
   - Оптимизируйте узкие места производительности
   - Улучшите пробелы в покрытии тестами
   - Улучшите документацию

3. **Требования к ревизии** (ОБЯЗАТЕЛЬНЫ)
   - Обновите README.md с любыми новыми функциями или изменениями
   - Обновите CLAUDE.md с улучшениями протокола из извлечённых уроков
   - Обновите документы спецификации и плана с финальным статусом
   - Пересмотрите архитектурные диаграммы при необходимости
   - Обновите API-документацию
   - Измените руководства по развёртыванию по мере необходимости
   - **КРИТИЧНО**: Обновите этот документ протокола на основе извлечённых уроков

4. **Систематический обзор проблем** (ОБЯЗАТЕЛЕН)
   - Просмотрите весь проект на систематические проблемы:
     - Повторяющиеся проблемы по фазам
     - Узкие места процесса или неэффективность
     - Отсутствующие паттерны документации
     - Накопление технического долга
     - Пробелы в тестировании или проблемы качества
   - Документируйте систематические находки в извлечённых уроках
   - Создайте пункты действий для решения систематических проблем

5. **Извлечённые уроки** (ОБЯЗАТЕЛЬНЫ)
   - Что прошло хорошо?
   - Что было сложным?
   - Что бы вы сделали по-другому?
   - Какие улучшения методологии необходимы?
   - Какие систематические проблемы были выявлены?

6. **Эволюция методологии**
   - Предложите улучшения процесса на основе уроков
   - Обновите документы протокола с улучшениями
   - Обновите шаблоны при необходимости
   - Поделитесь полученными знаниями с командой
   - Документируйте в `codev/reviews/`
   - **Важно**: Этот протокол должен эволюционировать на основе полученных уроков каждого проекта

**Вывод**:
- Единый документ обзора в `codev/reviews/####-описательное-имя.md`
- То же имя файла, что у спецификации/плана, фиксирует обзор и полученные уроки из этой функции
- Предложения по улучшению методологии (обновите протокол при необходимости)

**Требуется обзор**: Да - Рекомендуется командная ретроспектива

## Соглашения об именовании файлов

### Спецификации и планы
Формат: `####-описательное-имя.md`
- Используйте последовательную нумерацию (0001, 0002 и т.д.)
- Одинаковое имя файла в каталогах `specs/` и `plans/`
- Пример: `0001-аутентификация-пользователя.md`

## Отслеживание статуса

Статус отслеживается на уровне **фазы** в документах планов, а не на уровне документа.

Каждая фаза в плане должна иметь статус:
- `pending`: Не начата
- `in-progress`: В процессе выполнения
- `completed`: Фаза завершена и протестирована
- `blocked`: Не может продолжить из-за внешних факторов

## Интеграция с Git

### Формат сообщений коммитов

Для документов спецификации/плана:
```
[Spec ####] <стадия>: <описание>
```

Примеры:
```
[Spec 0001] Первоначальный черновик спецификации
[Spec 0001] Спецификация с мультиагентным обзором
[Spec 0001] Спецификация с обратной связью пользователя
[Spec 0001] Финальная утверждённая спецификация
```

Для реализации:
```
[Spec ####][Phase: <имя-фазы>] <тип>: <описание>

<опциональное подробное описание>
```

Пример:
```
[Spec 0001][Phase: user-auth] feat: Добавлен сервис хеширования паролей

Реализует хеширование паролей на основе bcrypt с настраиваемыми раундами
```

### Именование веток
```
spider/####-<имя-спецификации>/<имя-фазы>
```

Пример:
```
spider/0001-аутентификация-пользователя/схема-базы-данных
```

## Лучшие практики

### Во время спецификации
- Используйте чёткий, однозначный язык
- Включайте конкретные примеры
- Определяйте измеримые критерии успеха
- Ссылайтесь на соответствующие источники

### Во время планирования
- Держите фазы небольшими и сфокусированными
- Убедитесь, что каждая фаза доставляет ценность
- Отмечайте зависимости фаз инлайн (не нужно формальное отображение зависимостей)
- Включайте стратегии отката

### Во время реализации
- Следуйте плану, но документируйте отклонения
- Поддерживайте покрытие тестами
- Держите коммиты атомарными и хорошо описанными
- Обновляйте документацию по ходу

### Во время обзора
- Проверяйте по оригинальной спецификации
- Документируйте извлечённые уроки
- Предлагайте улучшения методологии
- Обновляйте оценки для будущей работы

## Шаблоны

Шаблоны для каждой фазы доступны в каталоге `templates/`:
- `spec.md` - Шаблон спецификации
- `plan.md` - Шаблон планирования (включает отслеживание статуса фаз)
- `review.md` - Шаблон обзора и извлечённых уроков

**Помните**: Создавайте только ТРИ документа на функцию - спецификацию, план и обзор с одинаковым именем файла в разных каталогах.

## Эволюция протокола

Этот протокол можно настроить под проект:
1. Форкните каталог протокола
2. Модифицируйте шаблоны и процессы
3. Документируйте изменения в `protocol-changes.md`
4. Делитесь улучшениями обратно с сообществом
