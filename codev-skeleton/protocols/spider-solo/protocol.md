# Протокол SPIDER-SOLO

## Предварительные условия

**Без внешних зависимостей**:
- SPIDER-SOLO — одноагентный вариант, Zen MCP не требуется
- Все проверки и валидации выполняются через самооценку
- Подходит, когда инфраструктура мультиконсультации недоступна

## Конфигурация протокола

### Только самооценка (БЕЗ мультиагентных консультаций)

**ПОВЕДЕНИЕ ПО УМОЛЧАНИЮ:**
SPIDER-SOLO полагается на собственный анализ и одобрение человека.

**КЛЮЧЕВОЕ ОТЛИЧИЕ ОТ SPIDER:**
- Нет консультаций с другими моделями
- Вся оценка проводится путём тщательного самоконтроля
- Упор на внимательный self-review перед показом пользователю

**ПОДХОД К РЕВЬЮ:**
- В каждом чекпойнте, где SPIDER консультируется с агентами, SOLO выполняет самооценку
- Применяйте критическое мышление для поиска пробелов
- Документируйте результаты self-review прозрачно
- Опирайтесь на обратную связь человека для финального подтверждения

## Обзор
SPIDER-SOLO — одноагентный вариант протокола SPIDER, сохраняющий спецификационный подход, итеративную реализацию и постоянный self-review. Структура соответствует оригиналу, но без командной работы нескольких агентов.

**Основной принцип**: каждая функция сопровождается ровно ТРЕМЯ документами — спецификацией, планом и обзором с уроками; у всех одинаковое имя и последовательный номер.

## Когда использовать SPIDER-SOLO

### Применяйте SPIDER-SOLO для:
- Разработки новых функций (когда Zen MCP недоступен)
- Архитектурных изменений (самостоятельный обзор)
- Сложных рефакторингов (самопроверка)
- Системного дизайна (с человеческим утверждением)
- Проектирования и реализации API
- Инициатив по оптимизации производительности

### Пропускайте SPIDER-SOLO при:
- Простых исправлениях (< 10 строк)
- Обновлениях документации
- Конфигурационных правках
- Обновлениях зависимостей
- Срочных хотфиксах (проведите лёгкое ретро отдельно)

## Фазы протокола

### S — Specify (исследование дизайна с самооценкой)

**Цель**: тщательно изучить задачу и варианты решения до выбора подхода.

**Краткий ход работы**:
1. Пользователь формулирует запрос
2. Агент готовит черновик спецификации
3. **КОММИТ**: «Черновик спецификации»
4. Провести критическую самооценку документа
5. Обновить спецификацию по результатам self-review
6. **КОММИТ**: «Спецификация после self-review»
7. Пользователь даёт комментарии
8. Агент вносит правки и фиксирует изменения
9. **КОММИТ**: «Спецификация после отзывов пользователя»
10. Повторная самооценка обновлённой версии
11. Финальные правки
12. **КОММИТ**: «Финально утверждённая спецификация»
13. Повторяйте шаги 7–12, пока пользователь не разрешит переход к планированию

**Важно**: используйте только ТРИ основных документа:
- `specs/####-описание.md` — спецификация
- `plans/####-описание.md` — план реализации
- `reviews/####-описание.md` — обзор и уроки

**Процесс**:
1. **Уточняющие вопросы**
   - Начинаем всегда с вопросов
   - Выявляем требования, ограничения, цели
   - Чётко формируем границы задачи

2. **Анализ проблемы**
   - Формулируем проблему
   - Определяем стейкхолдеров
   - Описываем текущее и целевое состояние
   - Фиксируем допущения и ограничения

3. **Исследование решений**
   - Генерируем несколько вариантов
   - Для каждого документируем дизайн, плюсы/минусы, сложность, риски

4. **Открытые вопросы**
   - Собираем неопределённости
   - Классифицируем: критичные / важные / nice-to-know

5. **Критерии успеха**
   - Определяем измеримые критерии
   - Добавляем требования по производительности и качеству
   - Описываем тестовые сценарии

6. **Процесс самооценки**
   - **Первый self-review** (после черновика):
     - Проверяем полноту решения, крайние случаи
     - Ищем пропущенные требования
     - Документируем найденные улучшения
     - Обновляем спецификацию
   - **Второй self-review** (после комментариев человека):
     - Убеждаемся, что правки согласованы
     - Проверяем полноту и связность
     - Финально полируем документ

   **Примечание**: никаких внешних консультаций — только собственная экспертиза.

**⚠️ ВАЖНО**: тщательная самооценка обязательна перед переходом дальше.

**Выход**: `codev/specs/####-описание.md`
- Включите раздел «Self-Review Notes» с выявленными улучшениями
- Коммиты отражают развитие документа
**Шаблон**: `templates/spec.md`
**Ревью**: одобрение человека после self-review

### P — Plan (структурированная декомпозиция)

**Цель**: превратить спецификацию в исполнимый план с фазами.

**⚠️ КРИТИЧНО: никаких временных оценок**
- Не используйте часы, дни, story points
- Скорость определяется циклами итераций, а не календарём
- Фокус на зависимостях и порядке работы
- Прогресс измеряем завершёнными фазами

**Краткий ход работы**:
1. Агент готовит черновик плана
2. **КОММИТ**: «Черновик плана»
3. Самооценка плана
4. Обновление с учётом self-review
5. **КОММИТ**: «План после self-review»
6. Пользователь вносит правки
7. Агент обновляет документ
8. **КОММИТ**: «План после отзывов пользователя»
9. Финальный self-review
10. Финальные правки
11. **КОММИТ**: «Финально утверждённый план»
12. Повторяем шаги 6–11 до согласования

**Цели проектирования фаз**:
- Каждая фаза — законченный, тестируемый блок
- Даёт наблюдаемую ценность
- Завершается обсуждением Evaluation и одним коммитом

**Процесс**:
1. **Определение фаз**
   - Делите работу на логические блоки
   - Пропишите зависимости прямо в описании
2. **Метрики готовности**
   - Что означает «готово» для каждой фазы
   - Требования к тестам и производительности
3. **Самооценка**
   - **Первая**: проверяем реализуемость, полноту
   - **Вторая**: после комментариев пользователя — убеждаемся, что план устойчив

**Выход**: `codev/plans/####-описание.md`
**Шаблон**: `templates/plan.md`
**Ревью**: подтверждение человека и осознанный self-review

### I — Implement (реализация)

**Цель**: реализовать функциональность текущей фазы строго по плану.

**Процесс**:
1. Убедитесь, что спецификация и план утверждены
2. Работайте в отдельной ветке
3. Привязывайте изменения к фазам плана
4. После завершения кода остановитесь и проведите self-review:
   - Проверьте, что код соответствует плану
   - Ищите риски, пропущенные сценарии
   - Оптимизируйте до демонстрации пользователю
5. Прогоните локальные проверки (линтеры, тесты)
6. Подготовьте список изменений для пользователя
7. Коммиты делайте осмысленными, но не объединяйте всё до завершения DEFEND/EVALUATE

### D — Defend (защитные тесты)

**Цель**: написать тесты, которые предотвратят регрессии и подтвердят требования.

**Процесс**:
1. Определите стратегию тестирования: что должно быть защищено
2. Напишите тесты, которые падают при нарушении требований
3. Проверьте, что тесты действительно ловят ошибки (анализ на overmocking)
4. Проведите self-review тестов: достаточно ли сценариев? нет ли ложноположительных?
5. Обновите документацию, если тесты выявили новые требования

### E — Evaluate (оценка)

**Цель**: подтвердить, что фаза выполнена в соответствии с критериями.

**Процесс**:
1. Сверьте результаты с планом и спецификацией
2. Убедитесь, что все тесты зелёные
3. Проведите self-review качества: нет ли чрезмерной сложности, долга
4. Подготовьте отчёт для пользователя (что сделано, что осталось)
5. Получите одобрение пользователя
6. Создайте единый коммит, закрывающий фазу, после одобрения

### R — Review (уроки и улучшения)

**Цель**: зафиксировать уроки, выявленные риски и улучшения методологии.

**Процесс**:
1. Соберите все артефакты
2. Опишите успехи, сложности, меры улучшения
3. Выделите системные проблемы
4. Обновите CLAUDE.md и протоколы при необходимости
5. Подготовьте обзор `codev/reviews/####-описание.md`
6. Проведите самооценку обзора, убедитесь, что уроки конкретны
7. Представьте выводы пользователю и обсуждайте предложенные улучшения

**Шаблон**: `templates/review.md`

## Дополнительные правила

### Коммиты и ветки
- Один коммит на фазу после одобрения пользователя
- Ветки формата `feature/####-описание`
- Не переходите к следующей фазе без коммита текущей

### Управление self-review
- В каждом документе создавайте раздел «Self-Review Notes»
- Честно фиксируйте выявленные пробелы и решения
- Если замечание отклонено — обоснуйте почему

### Трассируемость
- Ссылайтесь на спецификацию и план в коммитах и PR
- Обновляйте CLAUDE.md при появлении новых правил

### Документация
- Не создавайте лишние документы
- Обновляйте существующие по мере изменений
- Указывайте даты и версию

## Шаблоны
- Спецификация: `codev/protocols/spider-solo/templates/spec.md`
- План: `codev/protocols/spider-solo/templates/plan.md`
- Обзор: `codev/protocols/spider-solo/templates/review.md`

## Проверка готовности
- [ ] Спецификация утверждена человеком, проведён self-review
- [ ] План утверждён человеком, проведён self-review
- [ ] Для каждой фазы выполнены self-review после реализации, тестов и оценки
- [ ] Коммит выполнен после одобрения пользователя
- [ ] CLAUDE.md обновлён (если появились новые правила)
- [ ] Обзор с уроками подготовлен и обсуждён

SPIDER-SOLO позволяет работать по методологии SPIDER даже в одиночку: дисциплина self-review заменяет внешнюю консультацию, а спецификации остаются таким же «кодом», как и в оригинальном протоколе.
