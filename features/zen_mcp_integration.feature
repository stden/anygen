# language: ru
Функционал: Интеграция Zen MCP для мультиагентной консультации
  Как разработчик использующий Codev
  Я хочу консультироваться с несколькими AI-моделями
  Чтобы получить более качественный код и архитектурные решения

  Предыстория:
    Дано установлен Zen MCP server
    И настроен файл .env с API-ключами

  @requires-zen-mcp
  Сценарий: Проверка доступности Zen MCP
    Когда я выполняю команду "mcp list"
    Тогда Zen MCP отображается в списке серверов
    И статус Zen MCP "running"

  @requires-zen-mcp
  Сценарий: Проверка версии Zen MCP
    Когда я запрашиваю версию Zen MCP
    Тогда возвращается корректная версия сервера

  @requires-zen-mcp
  Сценарий: Консультация с Gemini 2.5 Pro
    Дано API-ключ Gemini настроен в .env
    Когда я запрашиваю консультацию у Gemini Pro
    Тогда получен ответ от Gemini
    И контекст консультации сохранён

  @requires-zen-mcp
  Сценарий: Консультация с GPT-5
    Дано API-ключ OpenAI настроен в .env
    Когда я запрашиваю консультацию у GPT-5
    Тогда получен ответ от GPT-5
    И качество ответа соответствует ожиданиям

  @requires-zen-mcp
  Сценарий: Мультиагентная консультация по архитектуре
    Дано доступны Gemini и GPT-5
    Когда я запрашиваю обзор архитектуры у обеих моделей
    Тогда получены ответы от Gemini и GPT-5
    И ответы имеют различные перспективы
    И найдены дополнительные инсайты

  Сценарий: Обработка ошибки при отсутствии API-ключа
    Дано API-ключи не настроены
    Когда я пытаюсь запросить консультацию
    Тогда возвращается сообщение об ошибке
    И указано "требуется API-ключ"

  Сценарий: Симлинк .env между проектом и Zen MCP
    Дано Zen MCP установлен через install-zen-mcp.sh
    Тогда ~/.zen-mcp-server/.env является симлинком
    И симлинк указывает на /srv/anygen/.env
    И изменения в .env проекта отражаются в Zen MCP

  Сценарий: Fallback на SPIDER-SOLO при недоступности Zen MCP
    Дано Zen MCP server недоступен для консультации
    Когда я начинаю новую фазу SPIDER
    Тогда автоматически используется SPIDER-SOLO
    И консультации заменены самопроверкой
    И workflow продолжается без ошибок
