# language: ru
Функционал: Протокол SPIDER для структурированной разработки
  Как AI-агент использующий Codev
  Я хочу следовать протоколу SPIDER
  Чтобы создавать качественный код с документацией и тестами

  Предыстория:
    Дано установлен протокол SPIDER
    И создан тестовый проект с Codev

  Сценарий: Фаза Specification - создание спецификации
    Когда я начинаю фазу Specification для "user authentication"
    Тогда создан файл "codev/specs/0001-user-authentication.md"
    И спецификация содержит секцию "Цель"
    И спецификация содержит секцию "Желаемое состояние"
    И спецификация содержит секцию "Критерии успеха"

  Сценарий: Фаза Planning - создание плана
    Дано спецификация "0001-user-authentication.md" создана
    Когда я начинаю фазу Planning
    Тогда создан файл "codev/plans/0001-user-authentication.md"
    И план разбит на конкретные фазы
    И каждая фаза имеет зависимости
    И каждая фаза имеет критерии завершения

  Сценарий: Фаза Implementation - реализация кода
    Дано план "0001-user-authentication.md" создан
    Когда я начинаю фазу Implementation
    Тогда код реализован согласно плану
    И создан git commit для каждой подфазы
    И commit messages следуют Conventional Commits

  Сценарий: Фаза Defend - написание тестов
    Дано реализация завершена
    Когда я начинаю фазу Defend
    Тогда созданы unit-тесты для всех функций
    И созданы интеграционные тесты
    И покрытие кода >= 90%
    И все тесты проходят успешно

  Сценарий: Фаза Evaluate - оценка качества
    Дано тесты написаны и проходят
    Когда я начинаю фазу Evaluate
    Тогда запущены все тесты
    И проверено соответствие спецификации
    И проверена производительность
    И создан отчёт оценки

  Сценарий: Фаза Review - извлечение уроков
    Дано все фазы завершены
    Когда я начинаю фазу Review
    Тогда создан файл "codev/reviews/0001-user-authentication.md"
    И обзор содержит "Что получилось хорошо"
    И обзор содержит "Что можно улучшить"
    И обзор содержит "Уроки на будущее"

  Сценарий: Мультиагентная консультация в SPIDER
    Дано Zen MCP доступен
    Когда я завершаю спецификацию
    Тогда запрашивается консультация у Gemini Pro
    И запрашивается консультация у GPT-5
    И спецификация обновлена на основе консультаций
    И зафиксированы мнения экспертов

Структура сценария: Нумерация документов
    Дано существуют спецификации "<существующие>"
    Когда я создаю новую спецификацию "<название>"
    Тогда файл создан с номером "<номер>"

    Примеры:
      | существующие              | название           | номер |
      | нет                       | feature-a          | 0001  |
      | 0001-feature-a            | feature-b          | 0002  |
      | 0001, 0002, 0003          | feature-d          | 0004  |
      | 0001, 0003 (пропуск 0002) | feature-new        | 0004  |
